MODIFICA√á√ïES PARA FAZER NO GITHUB:

===========================================
MUDAN√áA 1: Linha ~234 (m√©todo initialize)
===========================================

ENCONTRE:
async initialize() {
  // Evitar m√∫ltiplas inicializa√ß√µes simult√¢neas
  if (this.isInitializing || this.isReady) {
    return;
  }

SUBSTITUA POR:
async initialize() {
  // N√ÉO inicializar automaticamente sem userId (evitar inicializa√ß√£o no servidor)
  if (!this.userId) {
    console.warn('‚ö†Ô∏è [WhatsAppService] Tentativa de inicializar sem userId. Ignorando...');
    console.warn('üí° WhatsApp deve ser inicializado apenas via /api/whatsapp/connect com userId v√°lido');
    return;
  }

  // Evitar m√∫ltiplas inicializa√ß√µes simult√¢neas
  if (this.isInitializing || this.isReady) {
    return;
  }

===========================================
MUDAN√áA 2: Linha ~51 (m√©todo generateQRCode)
===========================================

ENCONTRE:
async generateQRCode() {
  if (this.qrCode) {
    return this.qrCode;
  }
  // Se o client n√£o existe, criar um novo
  if (!this.client) {
    await this.initialize();
  }
  return this.qrCode || 'QR Code n√£o dispon√≠vel no momento';
}

SUBSTITUA POR:
async generateQRCode() {
  if (this.qrCode) {
    return this.qrCode;
  }
  // Se o client n√£o existe, criar um novo (apenas se tiver userId)
  if (!this.client && this.userId) {
    await this.initialize();
  }
  if (!this.userId) {
    return 'QR Code n√£o dispon√≠vel: userId necess√°rio';
  }
  return this.qrCode || 'QR Code n√£o dispon√≠vel no momento';
}
